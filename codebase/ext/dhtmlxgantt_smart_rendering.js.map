{"version":3,"sources":["webpack:///dhtmlxgantt_smart_rendering.js","webpack:///webpack/bootstrap 39c67343b4e330efcd62","webpack:///./sources/ext/smart_rendering.js"],"names":["Gantt","plugin","gantt","modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","31","32","config","smart_rendering","_smart_render","getViewPort","timelineSize","$ui","getView","getSize","scrollPos","getScrollState","y","y_end","getScrollSizes","scroll","x","getVisibleTaskCount","row_height","isInViewPort","item","viewPort","isTaskDisplayed","id","task","this","getTaskPosition","isLinkDisplayed","link","getLinkPosition","getTaskTop","from_pos","source","to_pos","target","Math","min","max","getRange","buffer","port","firstTask","floor","lastTask","ceil","visibleTasks","$data","tasksStore","getIndexRange","visibleIds","length","push","_redrawItems","renderers","visibleItems","shouldBeVisible","t","alreadyVisible","r","render","rendered","node","parentNode","hide","restore","_getVisibleTasks","ids","rows","getTask","$index","resetProjectDates","_getVisibleLinks","visible_links","links","linksStore","_recalculateLinkedProjects","visibleLinks","recalculateTasks","isTaskExists","updateRender","callEvent","layers","$services","getService","taskRenderer","getDataRender","linkRenderer","getLayers","cached","_takeFromCache","payload","cacheName","undefined","initCache","caches","method","bind","calculate","cache","invalidateCache","clearViewPortCache","smartRender","clearDataCache","clearAllCache","clearTaskCache","clearLinkCache","attachEvent","oldLeft","oldTop","left","top","attachOnce","filters","detachEvent"],"mappings":"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","file":"dhtmlxgantt_smart_rendering.js","sourcesContent":["/*!\n * @license\r\n * \r\n * dhtmlxGantt v.5.1.0 Professional\r\n * This software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.\r\n * \r\n * (c) Dinamenta, UAB.\r\n * \n */\nGantt.plugin(function(gantt){\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 31);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 31:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(32);\n\n\n/***/ }),\n\n/***/ 32:\n/***/ (function(module, exports) {\n\ngantt.config.smart_rendering = true;\r\n\r\ngantt._smart_render = {\r\n\tgetViewPort: function(){\r\n\t\tvar timelineSize = gantt.$ui.getView(\"timeline\").getSize();\r\n\t\tvar scrollPos = gantt.getScrollState();\r\n\r\n\t\treturn {\r\n\t\t\ty: scrollPos.y,\r\n\t\t\ty_end: scrollPos.y + timelineSize.y\r\n\t\t};\r\n\t},\r\n\tgetScrollSizes: function(){\r\n\t\tvar scroll = gantt.getScrollState();\r\n\t\tscroll.x = scroll.x || 0;\r\n\t\tscroll.y = scroll.y || gantt.getVisibleTaskCount()*gantt.config.row_height;\r\n\t\treturn scroll;\r\n\t},\r\n\tisInViewPort: function(item, viewPort){\r\n\t\treturn !!(item.y < viewPort.y_end && item.y_end > viewPort.y);\r\n\t},\r\n\r\n\tisTaskDisplayed: function(id, task){\r\n\t\treturn this.isInViewPort(this.getTaskPosition(id), this.getViewPort());\r\n\t},\r\n\tisLinkDisplayed: function(id, link){\r\n\t\treturn this.isInViewPort(this.getLinkPosition(id, link), this.getViewPort());\r\n\t},\r\n\tgetTaskPosition: function(id){\r\n\t\tvar y = gantt.getTaskTop(id);\r\n\t\treturn {\r\n\t\t\ty: y,\r\n\t\t\ty_end: y + gantt.config.row_height\r\n\t\t};\r\n\t},\r\n\tgetLinkPosition: function(id, link){\r\n\t\tvar from_pos = gantt.getTaskTop(link.source),\r\n\t\t\tto_pos = gantt.getTaskTop(link.target);\r\n\r\n\t\treturn {\r\n\t\t\ty: Math.min(from_pos, to_pos),\r\n\t\t\ty_end: Math.max(from_pos, to_pos) + gantt.config.row_height\r\n\t\t};\r\n\t},\r\n\tgetRange: function(buffer){\r\n\t\tbuffer = buffer || 0;\r\n\r\n\t\tvar port = this.getViewPort();\r\n\r\n\t\tvar firstTask = Math.floor(Math.max(0, port.y) / gantt.config.row_height) - buffer;\r\n\t\tvar lastTask = Math.ceil(Math.max(0, port.y_end) / gantt.config.row_height) + buffer;\r\n\r\n\t\tvar visibleTasks = gantt.$data.tasksStore.getIndexRange(firstTask, lastTask);\r\n\t\tvar visibleIds = [];\r\n\t\tfor(var i = 0; i < visibleTasks.length; i++){\r\n\t\t\tvisibleIds.push(visibleTasks[i].id);\r\n\t\t}\r\n\r\n\t\treturn visibleIds;\r\n\t},\r\n\t_redrawItems: function(renderers, visibleItems){\r\n\t\tvar shouldBeVisible = {};\r\n\t\tfor(var t = 0; t < visibleItems.length; t++){\r\n\t\t\tshouldBeVisible[visibleItems[t].id] = true;\r\n\t\t}\r\n\t\tvar alreadyVisible = {};\r\n\r\n\t\tfor(var r = 0; r < renderers.length; r++){\r\n\t\t\tvar render = renderers[r];\r\n\r\n\t\t\tfor(var i in render.rendered){\r\n\t\t\t\tif(!shouldBeVisible[i]){\r\n\t\t\t\t\trender.hide(i);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar node = render.rendered[i];\r\n\t\t\t\t\tif(node && node.parentNode) {\r\n\t\t\t\t\t\talreadyVisible[i] = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor(var t = 0; t < visibleItems.length; t++){\r\n\t\t\t\tif(!alreadyVisible[visibleItems[t].id])\r\n\t\t\t\t\trender.restore(visibleItems[t]);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_getVisibleTasks: function(){\r\n\t\tvar ids = this.getRange();\r\n\t\tvar rows = [];\r\n\t\tfor(var i=0; i < ids.length; i++){\r\n\t\t\tvar item = gantt.getTask(ids[i]);\r\n\t\t\titem.$index = i;\r\n\t\t\t//this._update_parents(item.id, true);\r\n\t\t\tgantt.resetProjectDates(item);\r\n\t\t\trows.push(item);\r\n\t\t}\r\n\t\treturn rows;\r\n\t},\r\n\t_getVisibleLinks: function(){\r\n\t\tvar visible_links = [];\r\n\t\tvar links = gantt.$data.linksStore.getIndexRange();\r\n\r\n\t\tfor(var i = 0; i < links.length; i++){\r\n\t\t\tif(this.isLinkDisplayed(links[i].id, links[i])){\r\n\t\t\t\tvisible_links.push(links[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn visible_links;\r\n\t},\r\n\r\n\t_recalculateLinkedProjects: function(visibleLinks){\r\n\t\t// projects have dynamic duration, make sure that durations are recalculated before links display,\r\n\t\t// so links are shown on correct dates\r\n\t\tvar recalculateTasks = {};\r\n\t\tfor(var i = 0; i < visibleLinks.length; i++){\r\n\t\t\trecalculateTasks[visibleLinks[i].source] = true;\r\n\t\t\trecalculateTasks[visibleLinks[i].target] = true;\r\n\t\t}\r\n\r\n\t\tfor(var i in recalculateTasks){\r\n\t\t\tif(gantt.isTaskExists(i))\r\n\t\t\t\tgantt.resetProjectDates(gantt.getTask(i));\r\n\t\t}\r\n\t},\r\n\tupdateRender: function(){\r\n\t\tgantt.callEvent(\"onBeforeSmartRender\", []);\r\n\t\tvar visibleTasks = this._getVisibleTasks();\r\n\t\tvar visibleLinks = this._getVisibleLinks();\r\n\r\n\t\t// TODO: performance test\r\n\t\tthis._recalculateLinkedProjects(visibleLinks);\r\n\r\n\t\tvar layers = gantt.$services.getService(\"layers\");\r\n\r\n\t\tvar taskRenderer = layers.getDataRender(\"task\");\r\n\t\tvar linkRenderer = layers.getDataRender(\"link\");\r\n\r\n\t\tthis._redrawItems(taskRenderer.getLayers(), visibleTasks);\r\n\t\tthis._redrawItems(linkRenderer.getLayers(), visibleLinks);\r\n\t\tgantt.callEvent(\"onSmartRender\", []);\r\n\t},\r\n\r\n\tcached:{},\r\n\r\n\t_takeFromCache: function(id, payload, cacheName){\r\n\t\tif(!this.cached[cacheName])\r\n\t\t\tthis.cached[cacheName] = null;\r\n\t\tvar cached = this.cached[cacheName];\r\n\r\n\t\tif(id !== undefined){\r\n\t\t\tif(!cached){\r\n\t\t\t\tcached = this.cached[cacheName] = {};\r\n\t\t\t}\r\n\r\n\t\t\tif(cached[id] === undefined){\r\n\t\t\t\tcached[id] = payload(id);\r\n\t\t\t}\r\n\r\n\t\t\treturn cached[id];\r\n\t\t}else{\r\n\t\t\tif(!cached){\r\n\t\t\t\tcached = payload();\r\n\t\t\t}\r\n\t\t\treturn cached;\r\n\t\t}\r\n\r\n\t},\r\n\tinitCache:function(){\r\n\t\tvar caches = [\r\n\t\t\t\"getLinkPosition\",\r\n\t\t\t\"getTaskPosition\",\r\n\t\t\t\"isTaskDisplayed\",\r\n\t\t\t\"isLinkDisplayed\",\r\n\t\t\t\"getViewPort\",\r\n\t\t\t\"getScrollSizes\"\r\n\t\t];\r\n\r\n\t\tfor(var i = 0; i < caches.length; i++){\r\n\t\t\tvar method = caches[i];\r\n\t\t\tvar payload = gantt.bind(this[method], this);\r\n\r\n\t\t\tthis[method] = (function(calculate, cache){\r\n\t\t\t\treturn function(id){\r\n\t\t\t\t\treturn this._takeFromCache(id, calculate, cache);\r\n\t\t\t\t};\r\n\t\t\t})(payload, method);\r\n\t\t}\r\n\r\n\t\tthis.invalidateCache();\r\n\t\tthis.initCache = function(){};\r\n\t},\r\n\tinvalidateCache: function(){\r\n\t\tvar smartRender = this;\r\n\r\n\r\n\t\tfunction clearViewPortCache(){\r\n\t\t\tsmartRender.cached.getViewPort = null;\r\n\t\t\tsmartRender.cached.getScrollSizes = null;\r\n\t\t\tsmartRender.cached.isTaskDisplayed = null;\r\n\t\t\tsmartRender.cached.isLinkDisplayed = null;\r\n\t\t}\r\n\t\tfunction clearDataCache(){\r\n\t\t\tsmartRender.cached.isTaskDisplayed = null;\r\n\t\t\tsmartRender.cached.isLinkDisplayed = null;\r\n\t\t\tsmartRender.cached.getLinkPosition = null;\r\n\t\t\tsmartRender.cached.getTaskPosition = null;\r\n\t\t}\r\n\r\n\t\tfunction clearAllCache(){\r\n\t\t\tclearViewPortCache();\r\n\t\t\tclearDataCache();\r\n\t\t}\r\n\r\n\t\tfunction clearTaskCache(id){\r\n\t\t\tif(smartRender.cached.isTaskDisplayed){\r\n\t\t\t\tsmartRender.cached.isTaskDisplayed[id] = undefined;\r\n\t\t\t}\r\n\t\t\tif(smartRender.cached.getTaskPosition){\r\n\t\t\t\tsmartRender.cached.getTaskPosition[id] = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction clearLinkCache(id){\r\n\t\t\tif(smartRender.cached.isLinkDisplayed){\r\n\t\t\t\tsmartRender.cached.isLinkDisplayed[id] = undefined;\r\n\t\t\t}\r\n\t\t\tif(smartRender.cached.getLinkPosition){\r\n\t\t\t\tsmartRender.cached.getLinkPosition[id] = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tgantt.attachEvent(\"onClear\", function(){\r\n\t\t\tclearAllCache();\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onParse\", function(){\r\n\t\t\tclearAllCache();\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", clearLinkCache);\r\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", clearAllCache);\r\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", clearAllCache);\r\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", clearTaskCache);\r\n\t\tgantt.attachEvent(\"onGanttScroll\",  clearViewPortCache);\r\n\t\tgantt.attachEvent(\"onDataRender\", clearAllCache);\r\n\r\n\t\tthis.invalidateCache = function(){};\r\n\t}\r\n\r\n};\r\n\r\ngantt.attachEvent(\"onGanttScroll\", function(oldLeft, oldTop, left, top){\r\n\tif(gantt.config.smart_rendering){\r\n\r\n\t\tif((oldTop != top) || (oldLeft == left)){\r\n\r\n\t\t\tvar visibleTasks = gantt._smart_render.getRange();\r\n\t\t\tgantt._smart_render.updateRender();\r\n\r\n\t\t}\r\n\r\n\t}\r\n});\r\n\r\ngantt.attachEvent(\"onDataRender\", function() {\r\n\tif(gantt.config.smart_rendering){\r\n\t\tgantt._smart_render.updateRender();\r\n\t}\r\n});\r\n\r\n(function(){\r\n\tvar attachOnce = gantt.attachEvent(\"onGanttReady\", function(){\r\n\t\tvar layers = gantt.$services.getService(\"layers\");\r\n\t\tvar taskRenderer = layers.getDataRender(\"task\");\r\n\t\ttaskRenderer.filters.push(function(id, task){\r\n\t\t\tif(!gantt.config.smart_rendering)\r\n\t\t\t\treturn true;\r\n\t\t\telse\r\n\t\t\t\treturn !!gantt._smart_render.isTaskDisplayed(id, task);\r\n\t\t});\r\n\r\n\t\tvar linkRenderer = layers.getDataRender(\"link\");\r\n\t\tlinkRenderer.filters.push(function(id, link){\r\n\t\t\tif(!gantt.config.smart_rendering)\r\n\t\t\t\treturn true;\r\n\t\t\telse\r\n\t\t\t\treturn !!gantt._smart_render.isLinkDisplayed(id, link);\r\n\t\t});\r\n\r\n\t\tgantt.detachEvent(attachOnce);\r\n\t});\r\n})();\r\n\r\n\n\n/***/ })\n\n/******/ });\n});\n\n\n// WEBPACK FOOTER //\n// dhtmlxgantt_smart_rendering.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 31);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 39c67343b4e330efcd62","gantt.config.smart_rendering = true;\r\n\r\ngantt._smart_render = {\r\n\tgetViewPort: function(){\r\n\t\tvar timelineSize = gantt.$ui.getView(\"timeline\").getSize();\r\n\t\tvar scrollPos = gantt.getScrollState();\r\n\r\n\t\treturn {\r\n\t\t\ty: scrollPos.y,\r\n\t\t\ty_end: scrollPos.y + timelineSize.y\r\n\t\t};\r\n\t},\r\n\tgetScrollSizes: function(){\r\n\t\tvar scroll = gantt.getScrollState();\r\n\t\tscroll.x = scroll.x || 0;\r\n\t\tscroll.y = scroll.y || gantt.getVisibleTaskCount()*gantt.config.row_height;\r\n\t\treturn scroll;\r\n\t},\r\n\tisInViewPort: function(item, viewPort){\r\n\t\treturn !!(item.y < viewPort.y_end && item.y_end > viewPort.y);\r\n\t},\r\n\r\n\tisTaskDisplayed: function(id, task){\r\n\t\treturn this.isInViewPort(this.getTaskPosition(id), this.getViewPort());\r\n\t},\r\n\tisLinkDisplayed: function(id, link){\r\n\t\treturn this.isInViewPort(this.getLinkPosition(id, link), this.getViewPort());\r\n\t},\r\n\tgetTaskPosition: function(id){\r\n\t\tvar y = gantt.getTaskTop(id);\r\n\t\treturn {\r\n\t\t\ty: y,\r\n\t\t\ty_end: y + gantt.config.row_height\r\n\t\t};\r\n\t},\r\n\tgetLinkPosition: function(id, link){\r\n\t\tvar from_pos = gantt.getTaskTop(link.source),\r\n\t\t\tto_pos = gantt.getTaskTop(link.target);\r\n\r\n\t\treturn {\r\n\t\t\ty: Math.min(from_pos, to_pos),\r\n\t\t\ty_end: Math.max(from_pos, to_pos) + gantt.config.row_height\r\n\t\t};\r\n\t},\r\n\tgetRange: function(buffer){\r\n\t\tbuffer = buffer || 0;\r\n\r\n\t\tvar port = this.getViewPort();\r\n\r\n\t\tvar firstTask = Math.floor(Math.max(0, port.y) / gantt.config.row_height) - buffer;\r\n\t\tvar lastTask = Math.ceil(Math.max(0, port.y_end) / gantt.config.row_height) + buffer;\r\n\r\n\t\tvar visibleTasks = gantt.$data.tasksStore.getIndexRange(firstTask, lastTask);\r\n\t\tvar visibleIds = [];\r\n\t\tfor(var i = 0; i < visibleTasks.length; i++){\r\n\t\t\tvisibleIds.push(visibleTasks[i].id);\r\n\t\t}\r\n\r\n\t\treturn visibleIds;\r\n\t},\r\n\t_redrawItems: function(renderers, visibleItems){\r\n\t\tvar shouldBeVisible = {};\r\n\t\tfor(var t = 0; t < visibleItems.length; t++){\r\n\t\t\tshouldBeVisible[visibleItems[t].id] = true;\r\n\t\t}\r\n\t\tvar alreadyVisible = {};\r\n\r\n\t\tfor(var r = 0; r < renderers.length; r++){\r\n\t\t\tvar render = renderers[r];\r\n\r\n\t\t\tfor(var i in render.rendered){\r\n\t\t\t\tif(!shouldBeVisible[i]){\r\n\t\t\t\t\trender.hide(i);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar node = render.rendered[i];\r\n\t\t\t\t\tif(node && node.parentNode) {\r\n\t\t\t\t\t\talreadyVisible[i] = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor(var t = 0; t < visibleItems.length; t++){\r\n\t\t\t\tif(!alreadyVisible[visibleItems[t].id])\r\n\t\t\t\t\trender.restore(visibleItems[t]);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_getVisibleTasks: function(){\r\n\t\tvar ids = this.getRange();\r\n\t\tvar rows = [];\r\n\t\tfor(var i=0; i < ids.length; i++){\r\n\t\t\tvar item = gantt.getTask(ids[i]);\r\n\t\t\titem.$index = i;\r\n\t\t\t//this._update_parents(item.id, true);\r\n\t\t\tgantt.resetProjectDates(item);\r\n\t\t\trows.push(item);\r\n\t\t}\r\n\t\treturn rows;\r\n\t},\r\n\t_getVisibleLinks: function(){\r\n\t\tvar visible_links = [];\r\n\t\tvar links = gantt.$data.linksStore.getIndexRange();\r\n\r\n\t\tfor(var i = 0; i < links.length; i++){\r\n\t\t\tif(this.isLinkDisplayed(links[i].id, links[i])){\r\n\t\t\t\tvisible_links.push(links[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn visible_links;\r\n\t},\r\n\r\n\t_recalculateLinkedProjects: function(visibleLinks){\r\n\t\t// projects have dynamic duration, make sure that durations are recalculated before links display,\r\n\t\t// so links are shown on correct dates\r\n\t\tvar recalculateTasks = {};\r\n\t\tfor(var i = 0; i < visibleLinks.length; i++){\r\n\t\t\trecalculateTasks[visibleLinks[i].source] = true;\r\n\t\t\trecalculateTasks[visibleLinks[i].target] = true;\r\n\t\t}\r\n\r\n\t\tfor(var i in recalculateTasks){\r\n\t\t\tif(gantt.isTaskExists(i))\r\n\t\t\t\tgantt.resetProjectDates(gantt.getTask(i));\r\n\t\t}\r\n\t},\r\n\tupdateRender: function(){\r\n\t\tgantt.callEvent(\"onBeforeSmartRender\", []);\r\n\t\tvar visibleTasks = this._getVisibleTasks();\r\n\t\tvar visibleLinks = this._getVisibleLinks();\r\n\r\n\t\t// TODO: performance test\r\n\t\tthis._recalculateLinkedProjects(visibleLinks);\r\n\r\n\t\tvar layers = gantt.$services.getService(\"layers\");\r\n\r\n\t\tvar taskRenderer = layers.getDataRender(\"task\");\r\n\t\tvar linkRenderer = layers.getDataRender(\"link\");\r\n\r\n\t\tthis._redrawItems(taskRenderer.getLayers(), visibleTasks);\r\n\t\tthis._redrawItems(linkRenderer.getLayers(), visibleLinks);\r\n\t\tgantt.callEvent(\"onSmartRender\", []);\r\n\t},\r\n\r\n\tcached:{},\r\n\r\n\t_takeFromCache: function(id, payload, cacheName){\r\n\t\tif(!this.cached[cacheName])\r\n\t\t\tthis.cached[cacheName] = null;\r\n\t\tvar cached = this.cached[cacheName];\r\n\r\n\t\tif(id !== undefined){\r\n\t\t\tif(!cached){\r\n\t\t\t\tcached = this.cached[cacheName] = {};\r\n\t\t\t}\r\n\r\n\t\t\tif(cached[id] === undefined){\r\n\t\t\t\tcached[id] = payload(id);\r\n\t\t\t}\r\n\r\n\t\t\treturn cached[id];\r\n\t\t}else{\r\n\t\t\tif(!cached){\r\n\t\t\t\tcached = payload();\r\n\t\t\t}\r\n\t\t\treturn cached;\r\n\t\t}\r\n\r\n\t},\r\n\tinitCache:function(){\r\n\t\tvar caches = [\r\n\t\t\t\"getLinkPosition\",\r\n\t\t\t\"getTaskPosition\",\r\n\t\t\t\"isTaskDisplayed\",\r\n\t\t\t\"isLinkDisplayed\",\r\n\t\t\t\"getViewPort\",\r\n\t\t\t\"getScrollSizes\"\r\n\t\t];\r\n\r\n\t\tfor(var i = 0; i < caches.length; i++){\r\n\t\t\tvar method = caches[i];\r\n\t\t\tvar payload = gantt.bind(this[method], this);\r\n\r\n\t\t\tthis[method] = (function(calculate, cache){\r\n\t\t\t\treturn function(id){\r\n\t\t\t\t\treturn this._takeFromCache(id, calculate, cache);\r\n\t\t\t\t};\r\n\t\t\t})(payload, method);\r\n\t\t}\r\n\r\n\t\tthis.invalidateCache();\r\n\t\tthis.initCache = function(){};\r\n\t},\r\n\tinvalidateCache: function(){\r\n\t\tvar smartRender = this;\r\n\r\n\r\n\t\tfunction clearViewPortCache(){\r\n\t\t\tsmartRender.cached.getViewPort = null;\r\n\t\t\tsmartRender.cached.getScrollSizes = null;\r\n\t\t\tsmartRender.cached.isTaskDisplayed = null;\r\n\t\t\tsmartRender.cached.isLinkDisplayed = null;\r\n\t\t}\r\n\t\tfunction clearDataCache(){\r\n\t\t\tsmartRender.cached.isTaskDisplayed = null;\r\n\t\t\tsmartRender.cached.isLinkDisplayed = null;\r\n\t\t\tsmartRender.cached.getLinkPosition = null;\r\n\t\t\tsmartRender.cached.getTaskPosition = null;\r\n\t\t}\r\n\r\n\t\tfunction clearAllCache(){\r\n\t\t\tclearViewPortCache();\r\n\t\t\tclearDataCache();\r\n\t\t}\r\n\r\n\t\tfunction clearTaskCache(id){\r\n\t\t\tif(smartRender.cached.isTaskDisplayed){\r\n\t\t\t\tsmartRender.cached.isTaskDisplayed[id] = undefined;\r\n\t\t\t}\r\n\t\t\tif(smartRender.cached.getTaskPosition){\r\n\t\t\t\tsmartRender.cached.getTaskPosition[id] = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction clearLinkCache(id){\r\n\t\t\tif(smartRender.cached.isLinkDisplayed){\r\n\t\t\t\tsmartRender.cached.isLinkDisplayed[id] = undefined;\r\n\t\t\t}\r\n\t\t\tif(smartRender.cached.getLinkPosition){\r\n\t\t\t\tsmartRender.cached.getLinkPosition[id] = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tgantt.attachEvent(\"onClear\", function(){\r\n\t\t\tclearAllCache();\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onParse\", function(){\r\n\t\t\tclearAllCache();\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", clearLinkCache);\r\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", clearAllCache);\r\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", clearAllCache);\r\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", clearTaskCache);\r\n\t\tgantt.attachEvent(\"onGanttScroll\",  clearViewPortCache);\r\n\t\tgantt.attachEvent(\"onDataRender\", clearAllCache);\r\n\r\n\t\tthis.invalidateCache = function(){};\r\n\t}\r\n\r\n};\r\n\r\ngantt.attachEvent(\"onGanttScroll\", function(oldLeft, oldTop, left, top){\r\n\tif(gantt.config.smart_rendering){\r\n\r\n\t\tif((oldTop != top) || (oldLeft == left)){\r\n\r\n\t\t\tvar visibleTasks = gantt._smart_render.getRange();\r\n\t\t\tgantt._smart_render.updateRender();\r\n\r\n\t\t}\r\n\r\n\t}\r\n});\r\n\r\ngantt.attachEvent(\"onDataRender\", function() {\r\n\tif(gantt.config.smart_rendering){\r\n\t\tgantt._smart_render.updateRender();\r\n\t}\r\n});\r\n\r\n(function(){\r\n\tvar attachOnce = gantt.attachEvent(\"onGanttReady\", function(){\r\n\t\tvar layers = gantt.$services.getService(\"layers\");\r\n\t\tvar taskRenderer = layers.getDataRender(\"task\");\r\n\t\ttaskRenderer.filters.push(function(id, task){\r\n\t\t\tif(!gantt.config.smart_rendering)\r\n\t\t\t\treturn true;\r\n\t\t\telse\r\n\t\t\t\treturn !!gantt._smart_render.isTaskDisplayed(id, task);\r\n\t\t});\r\n\r\n\t\tvar linkRenderer = layers.getDataRender(\"link\");\r\n\t\tlinkRenderer.filters.push(function(id, link){\r\n\t\t\tif(!gantt.config.smart_rendering)\r\n\t\t\t\treturn true;\r\n\t\t\telse\r\n\t\t\t\treturn !!gantt._smart_render.isLinkDisplayed(id, link);\r\n\t\t});\r\n\r\n\t\tgantt.detachEvent(attachOnce);\r\n\t});\r\n})();\r\n\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/ext/smart_rendering.js\n// module id = 32\n// module chunks = 5"],"sourceRoot":""}